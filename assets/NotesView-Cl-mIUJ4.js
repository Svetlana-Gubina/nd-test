import{_ as N,u as L,r as b,b as O,d as V,o as a,c as i,e as l,f as S,L as I,g as c,a as t,w as q,h as B,v as F,t as u,F as M,i as A,j as E,k as x,l as T,M as D,m as R}from"./index-BTwvWLPc.js";const U={class:"form-wrapper"},j=["validation-schema"],H={class:"limit"},P={key:0,class:"error-message"},z={class:"limit"},G={key:1,class:"error-message"},J={key:2,class:"error-message"},K={__name:"CreateNoteForm",emits:["created"],setup(p,{emit:g}){const w=g,{loading:h,data:m,error:d,post:_,errorMessage:y,errorFields:f}=L("/api/notes"),s=b({name:"",note:""}),r=b({name:"",note:""}),v=O().shape({name:V().required("Введите название заметки").max(100,"Название должно включать не больше 100 символов"),note:V().required("Введите текст заметки").max(255,"Текст должен включать не больше 255 символов")}),k=n=>{v.validateAt(n,s.value).then(()=>{r.value[n]=""}).catch(e=>{r.value[n]=e.message})},C=()=>{const n={title:s.value.name,content:s.value.note};v.validate(s.value,{abortEarly:!1}).then(()=>(r.value={},_(n))).then(()=>{w("created",m.value)}).catch(e=>{e.inner.forEach(o=>{r.value[o.path]=o.message})})};return(n,e)=>(a(),i(M,null,[l(h)?(a(),S(I,{key:0})):c("",!0),t("div",U,[e[7]||(e[7]=t("h2",null,"Добавление заметки",-1)),t("form",{class:"form",method:"POST",onSubmit:e[4]||(e[4]=q((...o)=>n.onLoginFormSubmit&&n.onLoginFormSubmit(...o),["prevent"])),novalidate:"","validation-schema":l(v)},[e[5]||(e[5]=t("label",{for:"name"},"Название заметки",-1)),B(t("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>s.value.name=o),placeholder:"Введите название",onBlur:e[1]||(e[1]=o=>k("name"))},null,544),[[F,s.value.name]]),t("span",H,"0/"+u(s.value.name.length),1),r.value.name?(a(),i("p",P,u(r.value.name),1)):c("",!0),e[6]||(e[6]=t("label",{for:"note"},"Текст заметки",-1)),B(t("textarea",{id:"note",class:"textarea","onUpdate:modelValue":e[2]||(e[2]=o=>s.value.note=o),onBlur:e[3]||(e[3]=o=>k("note")),rows:"5"},null,544),[[F,s.value.note]]),t("span",z,"0/"+u(s.value.note.length),1),r.value.note?(a(),i("p",G,u(r.value.note),1)):c("",!0),t("div",{class:"form__footer"},[t("button",{onClick:C,type:"submit"},"Добавить")]),l(d)?(a(),i("div",J,u(l(f)||l(y)),1)):c("",!0)],40,j)])],64))}},Q=N(K,[["__scopeId","data-v-57dfb0bb"]]),W={class:"wrapper"},X={__name:"NoteCard",props:{note:{id:String,title:String,content:String}},emits:["remove"],setup(p,{emit:g}){const w=g,h=m=>{w("remove",m)};return(m,d)=>(a(),i("div",W,[t("h3",null,u(p.note.title),1),t("p",null,u(p.note.content),1),t("button",{type:"button",onClick:d[0]||(d[0]=_=>h(p.note.id))},d[1]||(d[1]=[t("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M1 1L17 17M17 1L1 17",stroke:"white","stroke-width":"2","stroke-linecap":"round"})],-1),A(" Удалить")]))]))}},Y=N(X,[["__scopeId","data-v-8752a8a2"]]),Z={class:"notes"},ee={class:"notes-list"},te={key:0,class:"error-message"},oe={__name:"NotesView",setup(p){const{error:g,loading:w,get:h,deleteItem:m,data:d,errorMessage:_,errorFields:y}=L("/api/notes"),f=b([]),s=b(!1),r=()=>{s.value=!0},v=()=>{s.value=!1},k=()=>{v(),n()},C=async e=>{await m(e),n()},n=async()=>{await h(),f.value=[...d.value]};return E(()=>{n()}),(e,o)=>(a(),i(M,null,[l(w)?(a(),S(I,{key:0})):c("",!0),x(D,{isOpen:s.value,onModalClose:v,name:"create-modal"},{content:T(()=>[x(Q,{onCreated:k})]),_:1},8,["isOpen"]),t("section",Z,[o[1]||(o[1]=t("h2",{class:"sr-only"},"Личный кабинет. Заметки пользователя",-1)),t("ul",ee,[(a(!0),i(M,null,R(f.value,$=>(a(),i("li",{class:"notes-item",key:$.id},[x(Y,{note:$,onRemove:C},null,8,["note"])]))),128))]),t("button",{class:"add",type:"button","aria-label":"Добавить заметки",onClick:r},o[0]||(o[0]=[t("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M1 9H17M9 1L9 17",stroke:"white","stroke-width":"2","stroke-linecap":"round"})],-1)])),l(g)?(a(),i("div",te,u(l(y)||l(_)),1)):c("",!0)])],64))}},ne=N(oe,[["__scopeId","data-v-16d00295"]]);export{ne as default};
